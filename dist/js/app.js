"use strict";function initMap(){map=new google.maps.Map($("#map").get(0),{center:start_point,styles:mapstyles,zoom:13,mapTypeControl:!1}),ko.applyBindings(new ViewModel)}var start_point={lat:33.448377,lng:-112.074037},map=void 0,ViewModel=function(){var e=this;this.current=ko.observable(),this.use_poi_icon=ko.observable(),this.markers=ko.observableArray([]),map.addListener("bounds_changed",function(){var o=new google.maps.places.Autocomplete($("#search-place").get(0),{bounds:map.getBounds()});o.addListener("place_changed",function(){var a=o.getPlace();e.searchPlaces(a.formatted_address)})}),this.search=function(){var o=this.current().trim();o&&e.searchPlaces(o)},this.searchPlaces=function(o){if(null==o&&(o=$("#search-place").get(0).value),o.length=0)window.alert("You must enter an address.");else{e.clearMarkers();var a=map.getBounds();new google.maps.places.PlacesService(map).textSearch({query:o,bounds:a},function(o,a){a===google.maps.places.PlacesServiceStatus.OK&&e.createMarkersForPlaces(o)})}},this.createMarkersForPlaces=function(o){for(var a=new google.maps.LatLngBounds,t=function(t){var n=o[t],i=void 0;i=e.use_poi_icon()?new google.maps.Marker({map:map,icon:{url:n.icon,size:new google.maps.Size(35,35),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(15,34),scaledSize:new google.maps.Size(25,25)},title:n.name,position:n.geometry.location,id:n.place_id}):new google.maps.Marker({map:map,title:n.name,position:n.geometry.location,id:n.place_id});var s=new google.maps.InfoWindow;i.addListener("click",function(){e.populateInfoWindow(this,s)}),e.markers.push(i),n.geometry.viewport?a.union(n.geometry.viewport):a.extend(n.geometry.location)},n=0;n<o.length;n++)t(n);map.fitBounds(a)},this.clearMarkers=function(){e.markers().forEach(function(e){e.setMap(null)}),e.markers.removeAll()},e.showPlaceInfo=function(e){google.maps.event.trigger(e,"click"),$("#nav").removeClass("open")}.bind(this),this.populateInfoWindow=function(e,o){if(o.marker!=e){o.setContent(""),o.marker=e,o.addListener("closeclick",function(){o.marker=null});(new google.maps.StreetViewService).getPanoramaByLocation(e.position,50,function(a,t){if(t==google.maps.StreetViewStatus.OK){var n=a.location.latLng,i=google.maps.geometry.spherical.computeHeading(n,e.position);o.setContent("<div>"+e.title+'</div><div id="pano"></div>');var s={position:n,pov:{heading:i,pitch:30}};new google.maps.StreetViewPanorama($("#pano").get(0),s)}else o.setContent("<div>"+e.title+"</div><div>No Street View Found</div>")}),o.open(map,e)}},this.toggleNav=function(){$("#nav").toggleClass("open"),event.stopPropagation()}};